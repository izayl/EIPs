(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{519:function(t,a,s){"use strict";s.r(a);var e=s(46),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("Replaced by "),s("RouterLink",{attrs:{to:"/eip-2535.html"}},[t._v("EIP-2535 Diamond Standard")]),t._v(".")],1),t._v(" "),s("h2",{attrs:{id:"simple-summary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#simple-summary"}},[t._v("#")]),t._v(" Simple Summary")]),t._v(" "),s("p",[t._v("This standard provides a contract architecture that makes upgradeable contracts flexible, unlimited in size, and transparent.")]),t._v(" "),s("p",[t._v("A transparent contract publicly documents the full history of all changes made to it.")]),t._v(" "),s("p",[t._v("All changes to a transparent contract are reported in a standard format.")]),t._v(" "),s("h2",{attrs:{id:"abstract"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[t._v("#")]),t._v(" Abstract")]),t._v(" "),s("p",[t._v("A transparent contract is a proxy contract design pattern that provides the following:")]),t._v(" "),s("ol",[s("li",[t._v("A way to add, replace and remove multiple functions of a contract atomically (at the same time).")]),t._v(" "),s("li",[t._v("Standard events to show what functions are added, replaced and removed from a contract, and why the changes are made.")]),t._v(" "),s("li",[t._v("A standard way to query a contract to discover and retrieve information about all functions exposed by it.")]),t._v(" "),s("li",[t._v("Solves the 24KB maximum contract size limitation, making the maximum contract size of a transparent contract practically unlimited. This standard makes the worry about contract size a thing of the past.")]),t._v(" "),s("li",[t._v("Enables an upgradeable contract to become immutable in the future if desired.")])]),t._v(" "),s("h2",{attrs:{id:"motivation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[t._v("#")]),t._v(" Motivation")]),t._v(" "),s("p",[t._v("A fundamental benefit of Ethereum contracts is that their code is immutable, thereby acquiring trust by trustlessness. People do not have to trust others if it is not possible for a contract to be changed.")]),t._v(" "),s("p",[t._v("However, a fundamental problem with trustless contracts that cannot be changed is that they cannot be changed.")]),t._v(" "),s("h4",{attrs:{id:"bugs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bugs"}},[t._v("#")]),t._v(" Bugs")]),t._v(" "),s("p",[t._v("Bugs and security vulnerabilities are unwittingly written into immutable contracts that ruin them.")]),t._v(" "),s("h4",{attrs:{id:"improvements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#improvements"}},[t._v("#")]),t._v(" Improvements")]),t._v(" "),s("p",[t._v("Immutable, trustless contracts cannot be improved, resulting in increasingly inferior contracts over time.")]),t._v(" "),s("p",[t._v("Contract standards evolve, new ones come out. People, groups and organizations learn over time what people want and what is better and what should be built next. Contracts that cannot be improved not only hold back the authors that create them, but everybody who uses them.")]),t._v(" "),s("h4",{attrs:{id:"upgradeable-contracts-vs-centralized-private-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#upgradeable-contracts-vs-centralized-private-database"}},[t._v("#")]),t._v(" Upgradeable Contracts vs. Centralized Private Database")]),t._v(" "),s("p",[t._v("Why have an upgradeable contract instead of a centralized, private, mutable database?\nHere are some reasons:")]),t._v(" "),s("ol",[s("li",[t._v("Because of the openness of storage data and verified code, it is possible to show a provable history of trustworthiness.")]),t._v(" "),s("li",[t._v("Because of the openness, bad behavior can be spotted and reported when it happens.")]),t._v(" "),s("li",[t._v("Independent security and domain experts can review the change history of contracts and vouch for their history of trustworthiness.")]),t._v(" "),s("li",[t._v("It is possible for an upgradeable contract to become immutable and trustless.")]),t._v(" "),s("li",[t._v("An upgradeable contract can have parts of it that are not upgradeable and so are partially immutable and trustless.")])]),t._v(" "),s("h4",{attrs:{id:"immutability"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#immutability"}},[t._v("#")]),t._v(" Immutability")]),t._v(" "),s("p",[t._v("In some cases immutable, trustless contracts are the right fit. This is the case when a contract is only needed for a short time or it is known ahead of time that there will never be any reason to change or improve it.")]),t._v(" "),s("h3",{attrs:{id:"middle-ground"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#middle-ground"}},[t._v("#")]),t._v(" Middle Ground")]),t._v(" "),s("p",[t._v("Transparent contracts provide a middle ground between immutable trustless contracts that can't be improved and upgradeable contracts that can't be trusted.")]),t._v(" "),s("h3",{attrs:{id:"purposes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#purposes"}},[t._v("#")]),t._v(" Purposes")]),t._v(" "),s("ol",[s("li",[t._v("Create upgradeable contracts that earn trust by showing a provable history of trustworthiness.")]),t._v(" "),s("li",[t._v("Document the development of contracts so their development and change is provably public and can be understood.")]),t._v(" "),s("li",[t._v("Create upgradeable contracts that can become immutable in the future if desired.")]),t._v(" "),s("li",[t._v("Create contracts that are not limited by a max size.")])]),t._v(" "),s("h3",{attrs:{id:"benefits-use-cases"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#benefits-use-cases"}},[t._v("#")]),t._v(" Benefits & Use Cases")]),t._v(" "),s("p",[t._v("This standard is for use cases that benefit from the following:")]),t._v(" "),s("ol",[s("li",[t._v("The ability to add, replace or remove multiple functions of a contract atomically (at the same time).")]),t._v(" "),s("li",[t._v("Each time a function is added, replaced or removed, it is documented with events.")]),t._v(" "),s("li",[t._v("Build trust over time by showing all changes made to a contract.")]),t._v(" "),s("li",[t._v("Unlimited contract size.")]),t._v(" "),s("li",[t._v("The ability to query information about functions currently supported by the contract.")]),t._v(" "),s("li",[t._v("One contract address that provides all needed functionality and never needs to be replaced by another contract address.")]),t._v(" "),s("li",[t._v("The ability for a contract to be upgradeable for a time, and then become immutable.")]),t._v(" "),s("li",[t._v('Add trustless guarantees to a contract with "unchangeable functions".')])]),t._v(" "),s("h3",{attrs:{id:"new-software-possibilities"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#new-software-possibilities"}},[t._v("#")]),t._v(" New Software Possibilities")]),t._v(" "),s("p",[t._v("This standard enables a form of contract version control software to be written.")]),t._v(" "),s("p",[t._v("Software and user interfaces can be written to filter the "),s("code",[t._v("FunctionUpdate")]),t._v(" and "),s("code",[t._v("CommitMessage")]),t._v(" events of a contract address. Such software can show the full history of changes of any contract that implements this standard.")]),t._v(" "),s("p",[t._v("User interfaces and software can also use this standard to assist or automate changes of contracts.")]),t._v(" "),s("h2",{attrs:{id:"specification"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[t._v("#")]),t._v(" Specification")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Note:")]),t._v("\nThe solidity "),s("code",[t._v("delegatecall")]),t._v(" opcode enables a contract to execute a function from another contract, but it is executed as if the function was from the calling contract. Essentially "),s("code",[t._v("delegatecall")]),t._v(' enables a contract to "borrow" another contract\'s function. Functions executed with '),s("code",[t._v("delegatecall")]),t._v(" affect the storage variables of the calling contract, not the contract where the functions are defined.")])]),t._v(" "),s("h3",{attrs:{id:"general-summary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#general-summary"}},[t._v("#")]),t._v(" General Summary")]),t._v(" "),s("p",[t._v("A transparent contract delegates or forwards function calls to it to other contracts using "),s("code",[t._v("delegatecode")]),t._v(".")]),t._v(" "),s("p",[t._v("A transparent contract has an "),s("code",[t._v("updateContract")]),t._v(" function that enables multiple functions to be added, replaced or removed.")]),t._v(" "),s("p",[t._v("An event is emitted for every function that is added, replaced or removed so that all changes to a contract can be tracked in a standard way.")]),t._v(" "),s("p",[t._v("A transparent contract is a contract that implements and complies with the design points below.")]),t._v(" "),s("h3",{attrs:{id:"terms"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#terms"}},[t._v("#")]),t._v(" Terms")]),t._v(" "),s("ol",[s("li",[t._v("In this standard a "),s("strong",[t._v("delegate contract")]),t._v(" is a contract that a transparent contract fallback function forwards function calls to using "),s("code",[t._v("delegatecall")]),t._v(".")]),t._v(" "),s("li",[t._v("In this standard an "),s("strong",[t._v("unchangeable function")]),t._v(" is a function that is defined directly in a transparent contract and so cannot be replaced or removed.")])]),t._v(" "),s("h3",{attrs:{id:"design-points"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#design-points"}},[t._v("#")]),t._v(" Design Points")]),t._v(" "),s("p",[t._v("A contract is a transparent contract if it implements the following design points:")]),t._v(" "),s("ol",[s("li",[t._v("A transparent contract is a contract that contains a fallback function, a constructor, and zero or more unchangeable functions that are defined directly within it.")]),t._v(" "),s("li",[t._v("The constructor of a transparent contract associates the "),s("code",[t._v("updateContract")]),t._v(" function with a contract that implements the ERC1538 interface. The "),s("code",[t._v("updateContract")]),t._v(' function can be an "unchangeable function" that is defined directly in the transparent contract or it can be defined in a delegate contract. Other functions can also be associated with contracts in the constructor.')]),t._v(" "),s("li",[t._v("After a transparent contract is deployed functions are added, replaced and removed by calling the "),s("code",[t._v("updateContract")]),t._v(" function.")]),t._v(" "),s("li",[t._v("The "),s("code",[t._v("updateContract")]),t._v(" function associates functions with contracts that implement those functions, and emits the "),s("code",[t._v("CommitMessage")]),t._v(" and "),s("code",[t._v("FunctionUpdate")]),t._v(" events that document function changes.")]),t._v(" "),s("li",[t._v("The "),s("code",[t._v("FunctionUpdate")]),t._v(" event is emitted for each function that is added, replaced or removed. The "),s("code",[t._v("CommitMessage")]),t._v(" event is emitted one time for each time the "),s("code",[t._v("updateContract")]),t._v(" function is called and is emitted after any "),s("code",[t._v("FunctionUpdate")]),t._v(" events are emitted.")]),t._v(" "),s("li",[t._v("The "),s("code",[t._v("updateContract")]),t._v(" function can take a list of multiple function signatures in its "),s("code",[t._v("_functionSignatures")]),t._v(" parameter and so add/replace/remove multiple functions at the same time.")]),t._v(" "),s("li",[t._v('When a function is called on a transparent contract it executes immediately if it is an "unchangeable function". Otherwise the fallback function is executed. The fallback function finds the delegate contract associated with the function and executes the function using '),s("code",[t._v("delegatecall")]),t._v(". If there is no delegate contract for the function then execution reverts.")]),t._v(" "),s("li",[t._v("The source code of a transparent contract and all delegate contracts used by it are publicly viewable and verified.")])]),t._v(" "),s("p",[t._v("The transparent contract address is the address that users interact with. The transparent contract address never changes. Only delegate addresses can change by using the "),s("code",[t._v("updateContracts")]),t._v(" function.")]),t._v(" "),s("p",[t._v("Typically some kind of authentication is needed for adding/replacing/removing functions from a transparent contract, "),s("strong",[t._v("however the scheme for authentication or ownership is not part of this standard")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[t._v("#")]),t._v(" Example")]),t._v(" "),s("p",[t._v("Here is an example of an implementation of a transparent contract. Please note that the example below is an "),s("strong",[t._v("example only.  It is not the standard")]),t._v(". A contract is a transparent contract when it implements and complies with the design points listed above.")]),t._v(" "),s("div",{staticClass:"language-solidity line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-solidity"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pragma")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("solidity")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),s("span",{pre:!0,attrs:{class:"token version number"}},[t._v("0.5.7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("contract")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExampleTransparentContract")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// owner of the contract")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" contractOwner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("OwnershipTransferred")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("indexed")]),t._v(" previousOwner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("indexed")]),t._v(" newOwner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// maps functions to the delegate contracts that execute the functions")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// funcId => delegate contract")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" delegates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// maps each function signature to its position in the funcSignatures array.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// signature => index+1")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" funcSignatureToIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CommitMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("FunctionUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("indexed")]),t._v(" functionId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("indexed")]),t._v(" oldDelegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("indexed")]),t._v(" newDelegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" functionSignature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// this is an example of an "unchangeable function".')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// return the delegate contract address for the supplied function signature")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("delegateAddress")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("calldata")]),t._v(" _functionSignature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("funcSignatureToIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_functionSignature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Function signature not found."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" delegates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("keccak256")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_functionSignature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add a function using the updateContract function")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this is an internal helper function")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" _erc1538Delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" contractAddress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" _functionSignatures"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" _commitMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 0x03A9BCCF == bytes4(keccak256("updateContract(address,string,string)"))')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" funcdata "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" abi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeWithSelector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x03A9BCCF")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" contractAddress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _functionSignatures"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _commitMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bool")]),t._v(" success"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assembly")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      success "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("delegatecall")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _erc1538Delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("funcdata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mload")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("funcdata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" funcdata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("success"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adding a function failed"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   \n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("constructor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" _erc1538Delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    contractOwner "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sender"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("emit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("OwnershipTransferred")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sender"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// adding ERC1538 updateContract function")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" signature "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"updateContract(address,string,string)"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes4")]),t._v(" funcId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("keccak256")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("signature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    delegates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("funcId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" _erc1538Delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("emit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("FunctionUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("funcId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _erc1538Delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("signature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("emit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CommitMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Added ERC1538 updateContract function at contract creation"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// associate "unchangeable functions" with this transparent contract address')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// prevents function selector clashes with delegate contract functions")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// uses the updateContract function")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" functions "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"delegateAddress(string)"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_erc1538Delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" functions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Associating unchangeable functions"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// adding ERC1538Query interface functions")]),t._v("\n    functions "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"functionByIndex(uint256)functionExists(string)delegateAddresses()delegateFunctionSignatures(address)functionById(bytes4)functionBySignature(string)functionSignatures()totalFunctions()"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "0x01234567891011121314" is an example address of an ERC1538Query delegate contract')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_erc1538Delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x01234567891011121314")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" functions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adding ERC1538Query functions"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// additional functions could be added at this point")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Making the fallback function payable makes it work for delegate contract functions ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// that are payable and not payable.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("payable")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Delegate every function call to a delegate contract")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" delegate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" delegates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delegate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Function does not exist."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assembly")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" ptr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mload")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x40")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calldatacopy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" calldatasize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("delegatecall")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ptr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" calldatasize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" size "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" returndatasize\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("returndatacopy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" result\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("revert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br"),s("span",{staticClass:"line-number"},[t._v("56")]),s("br"),s("span",{staticClass:"line-number"},[t._v("57")]),s("br"),s("span",{staticClass:"line-number"},[t._v("58")]),s("br"),s("span",{staticClass:"line-number"},[t._v("59")]),s("br"),s("span",{staticClass:"line-number"},[t._v("60")]),s("br"),s("span",{staticClass:"line-number"},[t._v("61")]),s("br"),s("span",{staticClass:"line-number"},[t._v("62")]),s("br"),s("span",{staticClass:"line-number"},[t._v("63")]),s("br"),s("span",{staticClass:"line-number"},[t._v("64")]),s("br"),s("span",{staticClass:"line-number"},[t._v("65")]),s("br"),s("span",{staticClass:"line-number"},[t._v("66")]),s("br"),s("span",{staticClass:"line-number"},[t._v("67")]),s("br"),s("span",{staticClass:"line-number"},[t._v("68")]),s("br"),s("span",{staticClass:"line-number"},[t._v("69")]),s("br"),s("span",{staticClass:"line-number"},[t._v("70")]),s("br"),s("span",{staticClass:"line-number"},[t._v("71")]),s("br"),s("span",{staticClass:"line-number"},[t._v("72")]),s("br"),s("span",{staticClass:"line-number"},[t._v("73")]),s("br"),s("span",{staticClass:"line-number"},[t._v("74")]),s("br"),s("span",{staticClass:"line-number"},[t._v("75")]),s("br"),s("span",{staticClass:"line-number"},[t._v("76")]),s("br"),s("span",{staticClass:"line-number"},[t._v("77")]),s("br"),s("span",{staticClass:"line-number"},[t._v("78")]),s("br"),s("span",{staticClass:"line-number"},[t._v("79")]),s("br"),s("span",{staticClass:"line-number"},[t._v("80")]),s("br")])]),s("p",[t._v("As can be seen in the above example, every function call is delegated to a delegate contract, unless the function is defined directly in the transparent contract (making it an unchangeable function).")]),t._v(" "),s("p",[t._v("The constructor function adds the "),s("code",[t._v("updateContract")]),t._v(" function to the transparent contract, which is then used to add other functions to the transparent contract.")]),t._v(" "),s("p",[t._v("Each time a function is added to a transparent contract the events "),s("code",[t._v("CommitMessage")]),t._v(" and "),s("code",[t._v("FunctionUpdate")]),t._v(" are emitted to document exactly what functions where added or replaced and why.")]),t._v(" "),s("p",[t._v("The delegate contract that implements the "),s("code",[t._v("updateContract")]),t._v(" function implements the following interface:")]),t._v(" "),s("h3",{attrs:{id:"erc1538-interface"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#erc1538-interface"}},[t._v("#")]),t._v(" ERC1538 Interface")]),t._v(" "),s("div",{staticClass:"language-solidity line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-solidity"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pragma")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("solidity")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),s("span",{pre:!0,attrs:{class:"token version number"}},[t._v("0.5.7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @title ERC1538 Transparent Contract Standard")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @dev Required interface")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  Note: the ERC-165 identifier for this interface is 0x61455567")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ERC1538")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @dev This emits when one or a set of functions are updated in a transparent contract.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  The message string should give a short description of the change and why")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  the change was made.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CommitMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @dev This emits for each function that is updated in a transparent contract.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  functionId is the bytes4 of the keccak256 of the function signature.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  oldDelegate is the delegate contract address of the old delegate contract if")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  the function is being replaced or removed.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  oldDelegate is the zero value address(0) if a function is being added for the")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  first time.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  newDelegate is the delegate contract address of the new delegate contract if ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  the function is being added for the first time or if the function is being ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  replaced.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  newDelegate is the zero value address(0) if the function is being removed.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("FunctionUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("indexed")]),t._v(" functionId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("indexed")]),t._v(" oldDelegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("indexed")]),t._v(" newDelegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" functionSignature\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Updates functions in a transparent contract.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @dev If the value of _delegate is zero then the functions specified ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  in _functionSignatures are removed.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  If the value of _delegate is a delegate contract address then the functions ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  specified in _functionSignatures will be delegated to that address.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @param _delegate The address of a delegate contract to delegate to or zero")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///        to remove functions.      ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @param _functionSignatures A list of function signatures listed one after the other")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @param _commitMessage A short description of the change and why it is made")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///        This message is passed to the CommitMessage event.          ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateContract")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" _delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("calldata")]),t._v(" _functionSignatures"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("calldata")]),t._v(" _commitMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br")])]),s("h3",{attrs:{id:"function-signatures-string-format"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#function-signatures-string-format"}},[t._v("#")]),t._v(" Function Signatures String Format")]),t._v(" "),s("p",[t._v("The text format for the "),s("code",[t._v("_functionSignatures")]),t._v(" parameter is simply a string of function signatures. For example: "),s("code",[t._v('"myFirstFunction()mySecondFunction(string)"')]),t._v(" This format is easy to parse and is concise.")]),t._v(" "),s("p",[t._v("Here is an example of calling the "),s("code",[t._v("updateContract")]),t._v(" function that adds the ERC721 standard functions to a transparent contract:")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("functionSignatures "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"approve(address,uint256)balanceOf(address)getApproved(uint256)isApprovedForAll(address,address)ownerOf(uint256)safeTransferFrom(address,address,uint256)safeTransferFrom(address,address,uint256,bytes)setApprovalForAll(address,bool)transferFrom(address,address,uint256)"')]),t._v("\ntx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" transparentContract"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateContract")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("erc721Delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("address"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" functionSignatures"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adding ERC721 functions"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"removing-functions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#removing-functions"}},[t._v("#")]),t._v(" Removing Functions")]),t._v(" "),s("p",[t._v("Functions are removed by passing "),s("code",[t._v("address(0)")]),t._v(" as the first argument to the "),s("code",[t._v("updateContract")]),t._v(" function. The list of functions that are passed in are removed.")]),t._v(" "),s("h3",{attrs:{id:"source-code-verification"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#source-code-verification"}},[t._v("#")]),t._v(" Source Code Verification")]),t._v(" "),s("p",[t._v("The transparent contract source code and the source code for the delegate contracts should be verified in a provable way by a third party source such as etherscan.io.\n")]),t._v(" "),s("h3",{attrs:{id:"function-selector-clash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#function-selector-clash"}},[t._v("#")]),t._v(" Function Selector Clash")]),t._v(" "),s("p",[t._v("A function selector clash occurs when a function is added to a contract that hashes to the same four-byte hash as an existing function. This is unlikely to occur but should be prevented in the implementation of the "),s("code",[t._v("updateContract")]),t._v(" function. See the "),s("a",{attrs:{href:"https://github.com/mudgen/transparent-contracts-erc1538",target:"_blank",rel:"noopener noreferrer"}},[t._v("reference implementation of ERC1538"),s("OutboundLink")],1),t._v(" to see an example of how function clashes can be prevented.")]),t._v(" "),s("h3",{attrs:{id:"erc1538query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#erc1538query"}},[t._v("#")]),t._v(" ERC1538Query")]),t._v(" "),s("p",[t._v("Optionally, the function signatures of a transparent contract can be stored in an array in the transparent contract and queried to get what functions the transparent contract supports and what their delegate contract addresses are.")]),t._v(" "),s("p",[t._v("The following is an optional interface for querying function information from a transparent contract:")]),t._v(" "),s("div",{staticClass:"language-solidity line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-solidity"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pragma")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("solidity")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),s("span",{pre:!0,attrs:{class:"token version number"}},[t._v("0.5.7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ERC1538Query")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Gets the total number of functions the transparent contract has.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @return The number of functions the transparent contract has,")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///  not including the fallback function.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("totalFunctions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Gets information about a specific function")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @dev Throws if `_index` >= `totalFunctions()`")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @param _index The index position of a function signature that is stored in an array")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @return The function signature, the function selector and the delegate contract address")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("functionByIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" functionSignature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes4")]),t._v(" functionId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" delegate\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Checks to see if a function exists")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @param The function signature to check")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @return True if the function exists, false otherwise")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("functionExists")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("calldata")]),t._v(" _functionSignature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Gets all the function signatures of functions supported by the transparent contract")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @return A string containing a list of function signatures")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("functionSignatures")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Gets all the function signatures supported by a specific delegate contract")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @param _delegate The delegate contract address")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @return A string containing a list of function signatures")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("delegateFunctionSignatures")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" _delegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Gets the delegate contract address that supports the given function signature")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @param The function signature")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @return The delegate contract address")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("delegateAddress")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("calldata")]),t._v(" _functionSignature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Gets information about a function")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @dev Throws if no function is found")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @param _functionId The id of the function to get information about")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @return The function signature and the contract address")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("functionById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes4")]),t._v(" _functionId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" signature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" delegate\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @notice Get all the delegate contract addresses used by the transparent contract")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// @return An array of all delegate contract addresses")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("delegateAddresses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br"),s("span",{staticClass:"line-number"},[t._v("56")]),s("br"),s("span",{staticClass:"line-number"},[t._v("57")]),s("br")])]),s("p",[t._v("See the "),s("a",{attrs:{href:"https://github.com/mudgen/transparent-contracts-erc1538",target:"_blank",rel:"noopener noreferrer"}},[t._v("reference implementation of ERC1538"),s("OutboundLink")],1),t._v(" to see how this is implemented.")]),t._v(" "),s("p",[t._v("The text format for the list of function signatures returned from the "),s("code",[t._v("delegateFunctionSignatures")]),t._v(" and "),s("code",[t._v("functionSignatures")]),t._v(" functions is simply a string of function signatures. Here is an example of such a string: "),s("code",[t._v('"approve(address,uint256)balanceOf(address)getApproved(uint256)isApprovedForAll(address,address)ownerOf(uint256)safeTransferFrom(address,address,uint256)safeTransferFrom(address,address,uint256,bytes)setApprovalForAll(address,bool)transferFrom(address,address,uint256)"')])]),t._v(" "),s("h3",{attrs:{id:"how-to-deploy-a-transparent-contract"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-deploy-a-transparent-contract"}},[t._v("#")]),t._v(" How To Deploy A Transparent Contract")]),t._v(" "),s("ol",[s("li",[t._v("Create and deploy to a blockchain a contract that implements the ERC1538 interface. You can skip this step if there is already such a contract deployed to the blockchain.")]),t._v(" "),s("li",[t._v("Create your transparent contract with a fallback function as given above. Your transparent contract also needs a constructor that adds the "),s("code",[t._v("updateContract")]),t._v(" function.")]),t._v(" "),s("li",[t._v("Deploy your transparent contract to a blockchain. Pass in the address of the ERC1538 delegate contract to your constructor if it requires it.")])]),t._v(" "),s("p",[t._v("See the "),s("a",{attrs:{href:"https://github.com/mudgen/transparent-contracts-erc1538",target:"_blank",rel:"noopener noreferrer"}},[t._v("reference implementation"),s("OutboundLink")],1),t._v(" for examples of these contracts.")]),t._v(" "),s("h3",{attrs:{id:"wrapper-contract-for-delegate-contracts-that-depend-on-other-delegate-contracts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wrapper-contract-for-delegate-contracts-that-depend-on-other-delegate-contracts"}},[t._v("#")]),t._v(" Wrapper Contract for Delegate Contracts that Depend on Other Delegate Contracts")]),t._v(" "),s("p",[t._v("In some cases some delegate contracts may need to call external/public functions that reside in other delegate contracts. A convenient way to solve this problem is to create a contract that contains empty implementations of functions that are needed and import and extend this contract in delegate contracts that call functions from other delegate contracts. This enables delegate contracts to compile without having to provide implementations of the functions that are already given in other delegate contracts. This is a way to save gas, prevent reaching the max contract size limit, and prevent duplication of code. This strategy was given by @amiromayer. "),s("a",{attrs:{href:"https://github.com/ethereum/EIPs/issues/1538#issuecomment-451985155",target:"_blank",rel:"noopener noreferrer"}},[t._v("See his comment for more information."),s("OutboundLink")],1),t._v(" Another way to solve this problem is to use assembly to call functions provided by other delegate contracts.")]),t._v(" "),s("h3",{attrs:{id:"decentralized-authority"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#decentralized-authority"}},[t._v("#")]),t._v(" Decentralized Authority")]),t._v(" "),s("p",[t._v("It is possible to extend this standard to add consensus functionality such as an approval function that multiple different people call to approve changes before they are submitted with the "),s("code",[t._v("updateContract")]),t._v(" function. Changes only go into effect when the changes are fully approved. The "),s("code",[t._v("CommitMessage")]),t._v(" and "),s("code",[t._v("FunctionUpdate")]),t._v(" events should only be emitted when changes go into effect.")]),t._v(" "),s("h2",{attrs:{id:"security"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#security"}},[t._v("#")]),t._v(" Security")]),t._v(" "),s("blockquote",[s("p",[t._v("This standard refers to "),s("strong",[t._v("owner(s)")]),t._v(" as one or more individuals that have the power to add/replace/remove functions of an upgradeable contract.")])]),t._v(" "),s("h3",{attrs:{id:"general"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#general"}},[t._v("#")]),t._v(" General")]),t._v(" "),s("p",[t._v("The owners(s) of an upgradeable contract have the ability to alter, add or remove data from the contract's data storage. Owner(s) of a contract can also execute any arbitrary code in the contract on behalf of any address. Owners(s) can do these things by adding a function to the contract that they call to execute arbitrary code. This is an issue for upgradeable contracts in general and is not specific to transparent contracts.")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Note:")]),t._v(" The design and implementation of contract ownership is "),s("strong",[t._v("not")]),t._v(" part of this standard. The examples given in this standard and in the reference implementation are just "),s("strong",[t._v("examples")]),t._v(" of how it could be done.")])]),t._v(" "),s("h3",{attrs:{id:"unchangeable-functions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unchangeable-functions"}},[t._v("#")]),t._v(" Unchangeable Functions")]),t._v(" "),s("p",[t._v("\"Unchangeable functions\" are functions defined in a transparent contract itself and not in a delegate contract. The owner(s) of a transparent contract are not able to replace these functions. The use of unchangeable functions is limited because in some cases they can still be manipulated if they read or write data to the storage of the transparent contract. Data read from the transparent contract's storage could have been altered by the owner(s) of the contract. Data written to the transparent contract's storage can be undone or altered by the owner(s) of the contract.")]),t._v(" "),s("p",[t._v("In some cases unchangeble functions add trustless guarantees to a transparent contract.")]),t._v(" "),s("h3",{attrs:{id:"transparency"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#transparency"}},[t._v("#")]),t._v(" Transparency")]),t._v(" "),s("p",[t._v("Contracts that implement this standard emit an event every time a function is added, replaced or removed. This enables people and software to monitor the changes to a contract. If any bad acting function is added to a contract then it can be seen. To comply with this standard all source code of a transparent contract and delegate contracts must be publicly available and verified.")]),t._v(" "),s("p",[t._v("Security and domain experts can review the history of change of any transparent contract to detect any history of foul play.")]),t._v(" "),s("h2",{attrs:{id:"rationale"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rationale"}},[t._v("#")]),t._v(" Rationale")]),t._v(" "),s("h3",{attrs:{id:"string-of-function-signatures-instead-of-bytes4-array-of-function-selectors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#string-of-function-signatures-instead-of-bytes4-array-of-function-selectors"}},[t._v("#")]),t._v(" String of Function Signatures Instead of bytes4[] Array of Function Selectors")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("updateContract")]),t._v(" function takes a "),s("code",[t._v("string")]),t._v(" list of functions signatures as an argument instead of a "),s("code",[t._v("bytes4[]")]),t._v(" array of function selectors for three reasons:")]),t._v(" "),s("ol",[s("li",[t._v("Passing in function signatures enables the implementation of "),s("code",[t._v("updateContract")]),t._v(" to prevent selector clashes.")]),t._v(" "),s("li",[t._v("A major part of this standard is to make upgradeable contracts more transparent by making it easier to see what has changed over time and why. When a function is added, replaced or removed its function signature is included in the FunctionUpdate event that is emitted. This makes it relatively easy to write software that filters the events of a contract to display to people what functions have been added/removed and changed over time without needing access to the source code or ABI of the contract. If only four-byte function selectors were provided this would not be possible.")]),t._v(" "),s("li",[t._v("By looking at the source code of a transparent contract it is not possible to see all the functions that it supports. This is why the ERC1538Query interface exists, so that people and software have a way to look up and examine or show all functions currently supported by a transparent contract. Function signatures are used so that ERC1538Query functions can show them.")])]),t._v(" "),s("h3",{attrs:{id:"gas-considerations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gas-considerations"}},[t._v("#")]),t._v(" Gas Considerations")]),t._v(" "),s("p",[t._v("Delegating function calls does have some gas overhead. This is mitigated in two ways:")]),t._v(" "),s("ol",[s("li",[t._v("Delegate contracts can be small, reducing gas costs. Because it costs more gas to call a function in a contract with many functions than a contract with few functions.")]),t._v(" "),s("li",[t._v("Because transparent contracts do not have a max size limitation it is possible to add gas optimizing functions for use cases. For example someone could use a transparent contract to implement the ERC721 standard and implement batch transfer functions from the "),s("a",{attrs:{href:"https://github.com/ethereum/EIPs/issues/1412",target:"_blank",rel:"noopener noreferrer"}},[t._v("ERC1412 standard"),s("OutboundLink")],1),t._v(" to help reduce gas (and make batch transfers more convenient).")])]),t._v(" "),s("h3",{attrs:{id:"storage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#storage"}},[t._v("#")]),t._v(" Storage")]),t._v(" "),s("p",[t._v("The standard does not specify how data is stored or organized by a transparent contract. But here are some suggestions:")]),t._v(" "),s("p",[s("strong",[t._v("Inherited Storage")])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("The storage variables of a transparent contract consist of the storage variables defined in the transparent contract source code and the source code of delegate contracts that have been added.")])]),t._v(" "),s("li",[s("p",[t._v("A delegate contract can use any storage variable that exists in a transparent contract as long as it defines within it all the storage variables that exist, in the order that they exist, up to and including the ones being used.")])]),t._v(" "),s("li",[s("p",[t._v("A delegate contract can create new storage variables as long as it has defined, in the same order, all storage variables that exist in the transparent contract.")])])]),t._v(" "),s("p",[t._v("Here is a simple way inherited storage could be implemented:")]),t._v(" "),s("ol",[s("li",[t._v("Create a storage contract that contains the storage variables that your transparent contract and delegate contracts will use.")]),t._v(" "),s("li",[t._v("Make your delegate contracts inherit the storage contract.")]),t._v(" "),s("li",[t._v("If you want to add a new delegate contract that adds new storage variables then create a new storage contract that adds the new storage variables and inherits from the old storage contract. Use your new storage contract with your new delegate contract.")]),t._v(" "),s("li",[t._v("Repeat steps 2 or 3 for every new delegate contract.")])]),t._v(" "),s("p",[s("strong",[t._v("Unstructured Storage")])]),t._v(" "),s("p",[t._v("Assembly is used to store and read data at specific storage locations. An advantage to this approach is that previously used storage locations don't have to be defined or mentioned in a delegate contract if they aren't used by it.")]),t._v(" "),s("p",[s("strong",[t._v("Eternal Storage")])]),t._v(" "),s("p",[t._v("Data can be stored using a generic API based on the type of data. "),s("a",{attrs:{href:"https://github.com/ethereum/EIPs/issues/930",target:"_blank",rel:"noopener noreferrer"}},[t._v("See ERC930 for more information."),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"becoming-immutable"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#becoming-immutable"}},[t._v("#")]),t._v(" Becoming Immutable")]),t._v(" "),s("p",[t._v("It is possible to make a transparent contract become immutable. This is done by calling the "),s("code",[t._v("updateContract")]),t._v(" function to remove the "),s("code",[t._v("updateContract")]),t._v(" function. With this gone it is no longer possible to add, replace and remove functions.")]),t._v(" "),s("h3",{attrs:{id:"versions-of-functions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#versions-of-functions"}},[t._v("#")]),t._v(" Versions of Functions")]),t._v(" "),s("p",[t._v("Software or a user can verify what version of a function is called by getting the delegate contract address of the function. This can be done by calling the "),s("code",[t._v("delegateAddress")]),t._v(" function from the ERC1538Query interface if it is implemented. This function takes a function signature as an argument and returns the delegate contract address where it is implemented.")]),t._v(" "),s("h3",{attrs:{id:"best-practices-tools-and-more-information"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#best-practices-tools-and-more-information"}},[t._v("#")]),t._v(" Best Practices, Tools and More Information")]),t._v(" "),s("blockquote",[s("p",[t._v("More information, tools, tutorials and best practices concerning transparent contracts need to be developed and published.")])]),t._v(" "),s("p",[t._v("Below is a growing list of articles concerning transparent contracts and their use.  If you have an article about transparent contracts you would like to share then please submit a comment to this issue about it to get it added.")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://coinjournal.net/erc1538-future-proofing-smart-contacts-and-tokens/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ERC1538: Future Proofing Smart Contracts and Tokens"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.crypto-economy.net/en/ethereum-eth-erc1538-transparent-contract-standard/",target:"_blank",rel:"noopener noreferrer"}},[t._v("The ERC1538 improving towards the transparent contract standard"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"inspiration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#inspiration"}},[t._v("#")]),t._v(" Inspiration")]),t._v(" "),s("p",[t._v("This standard was inspired by ZeppelinOS's implementation of "),s("a",{attrs:{href:"https://github.com/zeppelinos/labs/tree/master/upgradeability_with_vtable",target:"_blank",rel:"noopener noreferrer"}},[t._v("Upgradeability with vtables"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("This standard was also inspired by the design and implementation of the "),s("a",{attrs:{href:"https://etherscan.io/address/0xc1eab49cf9d2e23e43bcf23b36b2be14fc2f8838#code",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mokens contract"),s("OutboundLink")],1),t._v(" from the "),s("a",{attrs:{href:"https://github.com/Mokens/MIPs/blob/master/MIPS/mip-2-Goals-and-Objectives.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mokens project"),s("OutboundLink")],1),t._v(". The Mokens contract has been "),s("a",{attrs:{href:"https://etherscan.io/address/0x0ac5637fe62ec14fd9e237a81a9679d4adef701f#code",target:"_blank",rel:"noopener noreferrer"}},[t._v("upgraded to implement this standard"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"backwards-compatibility"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#backwards-compatibility"}},[t._v("#")]),t._v(" Backwards Compatibility")]),t._v(" "),s("p",[t._v("This standard makes a contract compatible with future standards and functionality because new functions can be added and existing functions can be replaced or removed.")]),t._v(" "),s("p",[t._v("This standard future proofs a contract.")]),t._v(" "),s("h2",{attrs:{id:"implementation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#implementation"}},[t._v("#")]),t._v(" Implementation")]),t._v(" "),s("p",[t._v("A reference implementation of this standard is given in the "),s("a",{attrs:{href:"https://github.com/mudgen/transparent-contracts-erc1538",target:"_blank",rel:"noopener noreferrer"}},[t._v("transparent-contracts-erc1538"),s("OutboundLink")],1),t._v(" repository.")]),t._v(" "),s("h2",{attrs:{id:"copyright"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[t._v("#")]),t._v(" Copyright")]),t._v(" "),s("p",[t._v("Copyright and related rights waived via "),s("a",{attrs:{href:"https://creativecommons.org/publicdomain/zero/1.0/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CC0"),s("OutboundLink")],1),t._v(".")])])}),[],!1,null,null,null);a.default=n.exports}}]);