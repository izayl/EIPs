(window.webpackJsonp=window.webpackJsonp||[]).push([[302],{724:function(e,t,a){"use strict";a.r(t);var s=a(46),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"simple-summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simple-summary"}},[e._v("#")]),e._v(" Simple Summary")]),e._v(" "),a("p",[e._v("A technique for contract authors to enable wallets to provide\na human-readable description of what a given contract\ninteraction (via a transaction or signed message) will perform.")]),e._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),a("p",[e._v("Human-readable descriptions for machine executable operations,\ndescribed in higher level machine readable data, so that wallets\ncan provide meaningful feedback to the user describing the\naction the user is about to perform.")]),e._v(" "),a("h2",{attrs:{id:"motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[e._v("#")]),e._v(" Motivation")]),e._v(" "),a("p",[e._v("When using an Ethereum Wallet (e.g. MetaMask, Clef, Hardware\nWallets) users must accept and authorize signing messages or\nsending transactions.")]),e._v(" "),a("p",[e._v("Due to the complexity of Ethereum transactions, wallets are very\nlimitd in their ability to provide insight into the contents of\ntransactions user are approving; outside special-cased support\nfor common transactions such as ERC20 transfers, this often amounts\nto asking the user to sign an opaque blob of binary data.")]),e._v(" "),a("p",[e._v("This EIP presents a method for dapp developers to enable a more\ncomfortable user experience by providing wallets with a means\nto generate a better description about what the contract claims\nwill happen.")]),e._v(" "),a("p",[e._v("It does not address malicious contracts which wish to lie, it\nonly addresses honest contracts that want to make their user's\nlife better. We believe that this is a reasonable security model,\nas transaction descriptions can be audited at the same time as\ncontract code, allowing auditors and code reviewers to check that\ntransaction descriptions are accurate as part of their review.")]),e._v(" "),a("h2",{attrs:{id:"specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[e._v("#")]),e._v(" Specification")]),e._v(" "),a("p",[e._v("The "),a("strong",[e._v("description string")]),e._v(" and "),a("strong",[e._v("described data")]),e._v(" are generated\nsimultaneously by evaluating the contract\n(i.e. the "),a("strong",[e._v("describer")]),e._v("), passing the "),a("strong",[e._v("describer inputs")]),e._v(" to the\nmethod:")]),e._v(" "),a("div",{staticClass:"language-solidity line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-solidity"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("eipXXXDescribe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[e._v("bytes")]),e._v(" describer_inputs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("view")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("returns")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[e._v("string")]),e._v(" description_string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[e._v("bytes")]),e._v(" described_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("The method must be executable in a static context, (i.e. any\nside effects, such as logX, sstore, etc.), including through\nindirect calls may be ignored.")]),e._v(" "),a("p",[e._v("During evaluation, the "),a("code",[e._v("ADDRESS")]),e._v(" (i.e. "),a("code",[e._v("to")]),e._v("), "),a("code",[e._v("CALLER")]),e._v("\n(i.e. "),a("code",[e._v("from")]),e._v("), "),a("code",[e._v("VALUE")]),e._v(", and "),a("code",[e._v("GASPRICE")]),e._v(" must be the same as the\nvalues for the transaction being described, so that the\ncode generating the description can rely on them. For signing\n"),a("strong",[e._v("described messages")]),e._v(", "),a("code",[e._v("VALUE")]),e._v(" should always be 0.")]),e._v(" "),a("p",[e._v("When executing the bytecode, best efforts should be made to\nensure "),a("code",[e._v("BLOCKHASH")]),e._v(", "),a("code",[e._v("NUMBER")]),e._v(", "),a("code",[e._v("TIMESTAMP")]),e._v(" and "),a("code",[e._v("DIFFICULTY")]),e._v("\nmatch the "),a("code",[e._v('"latest"')]),e._v(" block. The "),a("code",[e._v("COINBASE")]),e._v(" should be the zero\naddress.")]),e._v(" "),a("p",[e._v("The method may revert, in which case the signing must be aborted.")]),e._v(" "),a("h3",{attrs:{id:"new-json-rpc-methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#new-json-rpc-methods"}},[e._v("#")]),e._v(" New JSON-RPC Methods")]),e._v(" "),a("p",[e._v("Clients which manage private keys should expose additional\nmethods for interacting with the related accounts.")]),e._v(" "),a("p",[e._v("If an user interface is not present or expected for any other\naccount-based operations, the description strings should be\nignored and the described data used directly.")]),e._v(" "),a("p",[e._v("These JSON-RPC methods will also be implemented in standard\nEthereum libraries, so the JSON-RPC description is meant more\nof a canonical way to describe them.")]),e._v(" "),a("h3",{attrs:{id:"signing-described-messages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signing-described-messages"}},[e._v("#")]),e._v(" Signing Described Messages")]),e._v(" "),a("div",{staticClass:"language-solidity line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-solidity"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("eth_signDescribedMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[e._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" describer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" describerInput"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Result: {")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('//   description: "text/plain;Hello World",')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('//   data: "0x...", // described data')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('//   signature: "0x..."')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// }")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br")])]),a("p",[e._v("Compute the "),a("strong",[e._v("description string")]),e._v(" and "),a("strong",[e._v("described data")]),e._v(" by\nevaluating the call to "),a("strong",[e._v("describer")]),e._v(", with the\n"),a("strong",[e._v("describerInput")]),e._v(" passed to the ABI encoded call to\n"),a("code",[e._v("eipXXXDescription(bytes)")]),e._v(". The "),a("code",[e._v("VALUE")]),e._v(" during execution must\nbe 0.")]),e._v(" "),a("p",[e._v("If the wallet contains a user interface for accepting or\ndenying signing a message, it should present the description\nstring to the user. Optionally, a wallet may wish to\nadditionally provide a way to examine the described data.")]),e._v(" "),a("p",[e._v("If accepted, the computed "),a("strong",[e._v("described data")]),e._v(" is signed\naccording to "),a("RouterLink",{attrs:{to:"/eip-191.html"}},[e._v("EIP-191")]),e._v(", with the "),a("em",[e._v("version\nbyte")]),e._v(" of "),a("code",[e._v("0x00")]),e._v(" and the "),a("em",[e._v("version specific data")]),e._v(" of describer\naddress.")],1),e._v(" "),a("p",[e._v("That is:")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("0x19   0x00   DESCRIBER_ADDRESS   0xDESCRIBED_DATA\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("The returned result includes the "),a("strong",[e._v("described data")]),e._v(", allowing\ndapps that use parameters computed in the contract to be\navailable.")]),e._v(" "),a("h3",{attrs:{id:"sending-described-transactions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sending-described-transactions"}},[e._v("#")]),e._v(" Sending Described Transactions")]),e._v(" "),a("div",{staticClass:"language-solidity line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-solidity"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("eth_sendDescribedTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[e._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0x..."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1234")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  nonce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("42")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  gas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("42000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  gasPrice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("9000000000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  describerInput"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0x1234..."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Result: {")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('//   description: "text/plain;Hello World",')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('//   transaction: "0x...", // serialized signed transaction')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// }")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br")])]),a("p",[e._v("Compute the "),a("strong",[e._v("description string")]),e._v(" and "),a("strong",[e._v("described data")]),e._v(" by\nevaluating the call to the "),a("strong",[e._v("describer")]),e._v(" "),a("code",[e._v("to")]),e._v(", with the\n"),a("strong",[e._v("describerInput")]),e._v(" passed  to the ABI encoded call to\n"),a("code",[e._v("eipXXXDescription(bytes)")]),e._v(".")]),e._v(" "),a("p",[e._v("If the wallet contains a user interface for accepting or\ndenying a transaction, it should present the description string\nalong with fee and value information. Optionally, a wallet may\nwish to additionally provide a way to further examine the\ntransaction.")]),e._v(" "),a("p",[e._v("If accepted, the transaction data is set to the computed\n"),a("strong",[e._v("described data")]),e._v(", the derived transaction is signed and sent,\nand the "),a("strong",[e._v("description string")]),e._v(" and serialized signed\ntransaction is returned.")]),e._v(" "),a("h3",{attrs:{id:"signing-described-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signing-described-transaction"}},[e._v("#")]),e._v(" Signing Described Transaction")]),e._v(" "),a("div",{staticClass:"language-solidity line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-solidity"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("eth_signDescribedTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[e._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0x..."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1234")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  nonce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("42")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  gas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("42000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  gasPrice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("9000000000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  describerInput"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0x1234..."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Result: {")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('//   description: "text/plain;Hello World",')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('//   transaction: "0x...", // serialized signed transaction')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// }")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br")])]),a("p",[e._v("Compute the "),a("strong",[e._v("description string")]),e._v(" and "),a("strong",[e._v("described data")]),e._v(" by\nevaluating the call to the "),a("strong",[e._v("describer")]),e._v(" "),a("code",[e._v("to")]),e._v(", with the\n"),a("strong",[e._v("describerInput")]),e._v(" passed  to the ABI encoded call to\n"),a("code",[e._v("eipXXXDescription(bytes)")]),e._v(".")]),e._v(" "),a("p",[e._v("If the wallet contains a user interface for accepting or\ndenying a transaction, it should present the description string\nalong with fee and value information. Optionally, a wallet may\nwish to additionally provide a way to further examine the\ntransaction.")]),e._v(" "),a("p",[e._v("If accepted, the transaction data is set to the computed\n"),a("strong",[e._v("described data")]),e._v(", the derived transaction is signed (and not\nsent) and the "),a("strong",[e._v("description string")]),e._v(" and serialized signed\ntransaction is returned.")]),e._v(" "),a("h3",{attrs:{id:"description-strings"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#description-strings"}},[e._v("#")]),e._v(" Description Strings")]),e._v(" "),a("p",[e._v("A "),a("strong",[e._v("description string")]),e._v(" must begin with a mime-type followed\nby a semi-colon ("),a("code",[e._v(";")]),e._v("). This EIP specifies only the "),a("code",[e._v("text/plain")]),e._v("\nmime-type, but future EIPs may specify additional types to\nenable more rich processing, such as "),a("code",[e._v("text/markdown")]),e._v(" so that\naddresses can be linkable within clients or to enable\nmulti-locale options, similar to multipart/form-data.")]),e._v(" "),a("h2",{attrs:{id:"rationale"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rationale"}},[e._v("#")]),e._v(" Rationale")]),e._v(" "),a("h3",{attrs:{id:"meta-description"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#meta-description"}},[e._v("#")]),e._v(" Meta Description")]),e._v(" "),a("p",[e._v("There have been many attempts to solve this problem, many of\nwhich attempt to examine the encoded transaction data or\nmessage data directly.")]),e._v(" "),a("p",[e._v("In many cases, the information that would be necessary for a\nmeaningful description is not present in the final encoded\ntransaction data or message data.")]),e._v(" "),a("p",[e._v("Instead this EIP uses an indirect description of the data.")]),e._v(" "),a("p",[e._v("For example, the "),a("code",[e._v("commit(bytes32)")]),e._v(" method of ENS places a\ncommitement "),a("strong",[e._v("hash")]),e._v(" on-chain. The hash contains the\n"),a("strong",[e._v("blinded")]),e._v(" name and address; since the name is blinded, the\nencoded data (i.e. the hash) no longer contains the original\nvalues and is insufficient to access the necessary values to\nbe included in a description.")]),e._v(" "),a("p",[e._v('By instead describing the commitment indirectly (with the\noriginal information intact: NAME, ADDRESS and SECRET) a\nmeaningful description can be computed (e.g. "commit to NAME for ADDRESS (with SECRET)")\nand the matching data can be computed (i.e. '),a("code",[e._v("commit(hash(name, owner, secret))")]),e._v(").")]),e._v(" "),a("h3",{attrs:{id:"entangling-the-contract-address"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#entangling-the-contract-address"}},[e._v("#")]),e._v(" Entangling the Contract Address")]),e._v(" "),a("p",[e._v("To prevent data being signed from one contract being used\nagainst another, the contract address is entanlged into\nboth the transaction (implicitly via the "),a("code",[e._v("to")]),e._v(" field) and\nin messages by the EIP-191 versions specific data.")]),e._v(" "),a("p",[e._v("The use of the zero address is reserved.")]),e._v(" "),a("h3",{attrs:{id:"alternatives"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#alternatives"}},[e._v("#")]),e._v(" Alternatives")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("NatSpec and company are a class of more complex languages that attempt to describe the encoded data directly. Because of the language complexity they often end up being quite large requiring entire runtime environments with ample processing power and memory, as well as additional sandboxing to reduce security concerns. One goal of this is to reduce the complexity to something that could execute on hardware wallets and other simple wallets. These also describe the data directly, which in many cases (such as blinded data), cannot adequately describe the data at all")])]),e._v(" "),a("li",[a("p",[e._v("Custom Languages; due to the complexity of Ethereum transactions, any language used would require a lot of expressiveness and re-inventing the wheel. The EVM already exists (it may not be ideal), but it is there and can handle everything necessary.")])]),e._v(" "),a("li",[a("p",[e._v("Format Strings (e.g. Trustless Signing UI Protocol; format strings can only operate on the class of regular languages, which in many cases is insufficient to describe an Ethereum transaction. This was an issue quite often during early attempts at solving this problem.")])]),e._v(" "),a("li",[a("p",[e._v("The signTypedData "),a("RouterLink",{attrs:{to:"/eip-712.html"}},[e._v("EIP-712")]),e._v(" has many parallels to what this EIP aims to solve")],1)]),e._v(" "),a("li",[a("p",[e._v("@TODO: More")])])]),e._v(" "),a("h2",{attrs:{id:"backwards-compatibility"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backwards-compatibility"}},[e._v("#")]),e._v(" Backwards Compatibility")]),e._v(" "),a("p",[e._v("All signatures for messages are generated using "),a("RouterLink",{attrs:{to:"/eip-191.html"}},[e._v("EIP-191")]),e._v("\nwhich had a previously compatible version byte of "),a("code",[e._v("0x00")]),e._v(", so\nthere should be no concerns with backwards compatibility.")],1),e._v(" "),a("h2",{attrs:{id:"test-cases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-cases"}},[e._v("#")]),e._v(" Test Cases")]),e._v(" "),a("p",[e._v("All test cases operate against the published and verified contracts:")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://ropsten.etherscan.io/address/0x7a89c0521604008c93c97aa76950198bca73d933#code",target:"_blank",rel:"noopener noreferrer"}},[e._v("Formatter"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://ropsten.etherscan.io/address/0xab3045aa85cbcabb06ed3f3fe968fa5457727270#code",target:"_blank",rel:"noopener noreferrer"}},[e._v("TestFormatter"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("The private key used for signing messages and transactions is:")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('privateKey = "0x6283185307179586476925286766559005768394338798750211641949889184"\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"messages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#messages"}},[e._v("#")]),e._v(" Messages")]),e._v(" "),a("p",[a("strong",[e._v("Example: login with signed message")])]),e._v(" "),a("ul",[a("li",[e._v("sends selector login()")]),e._v(" "),a("li",[e._v("received data with selector doLogin(bytes32 timestamp)")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Input:\n  Address:         0xab3045AA85cBCaBb06eD3F3FE968fA5457727270\n  Describer Input: 0xb34e97e800000000000000000000000000000000000000000000000000000000\n  i.e.             encode(\n                       [ "bytes4" ],\n                       [ SEL("login()") ]\n                   )\n\nOutput:\n  Description:     text/plain;Log into ethereum.org?\n  Data:            0x14629d78000000000000000000000000000000000000000000000000000000006010d607\n  i.e.             encodeWithSelector("doLogin(bytes32)", "0x000000000000000000000000000000000000000000000000000000006010d607" ]\n\nSigning:\n  Preimage:  0x1900ab3045aa85cbcabb06ed3f3fe968fa545772727014629d78000000000000000000000000000000000000000000000000000000006010d607\n  Signature: 0x8b9def29343c85797a580c5cd3607c06e78a53351219f9ba706b9985c1a3c91e702bf678e07f5daf5ef48b3e3cc581202de233904b72cf2c4f7d714ce92075b21c\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br")])]),a("h3",{attrs:{id:"transactions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#transactions"}},[e._v("#")]),e._v(" Transactions")]),e._v(" "),a("p",[e._v("All transaction test cases use the ropsten network (chainId: 3)\nand for all unspecified properties use 0.")]),e._v(" "),a("p",[a("strong",[e._v("Example: ERC-20 transfer")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Input:\n  Address:            0xab3045AA85cBCaBb06eD3F3FE968fA5457727270\n  Describer Input:    0xa9059cbb000000000000000000000000000000000000000000000000000000000000000000000000000000008ba1f109551bd432803012645ac136ddd64dba720000000000000000000000000000000000000000000000002b992b75cbeb6000\n  i.e.                encode(\n                          [ "bytes4", "address", "uint"],\n                          [ SEL("transfer(address,uint256)"), "0x8ba1f109551bD432803012645Ac136ddd64DBA72", 3.14159e18 ]\n                      )\nOutput:\n  Description:        text/plain;Send 3.14159 TOKN to "ricmoose.eth" (0x8ba1f109551bD432803012645Ac136ddd64DBA72)?\n  Described Data:     0xa9059cbb0000000000000000000000000000000000000000000000002b992b75cbeb60000000000000000000000000008ba1f109551bd432803012645ac136ddd64dba72\n  i.e.                encodeWithSelector("transfer(address,uint256)", "0x8ba1f109551bD432803012645Ac136ddd64DBA72", 3.14159e18)\n\nSigning:\n  Signed Transaction: 0xf8a280808094ab3045aa85cbcabb06ed3f3fe968fa545772727080b844a9059cbb0000000000000000000000000000000000000000000000002b992b75cbeb60000000000000000000000000008ba1f109551bd432803012645ac136ddd64dba7229a0f33ea492d326ac32d9b7ae203c61bf7cf0ac576fb0cf8be8e4c63dc89c90de12a06c8efb28aaf3b70c032b3bd1edfc664578c49f040cf749bb19b000da56507fb2\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br")])]),a("p",[a("strong",[e._v("Example: ERC-20 approve")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Input:\n  Address:            0xab3045AA85cBCaBb06eD3F3FE968fA5457727270\n  Describer Input:    0x095ea7b3000000000000000000000000000000000000000000000000000000000000000000000000000000008ba1f109551bd432803012645ac136ddd64dba720000000000000000000000000000000000000000000000002b992b75cbeb6000\n  i.e.                encode(\n                          [ "bytes4", "address", "uint"],\n                          [ SEL("approve(address,uint256)"), "0x8ba1f109551bD432803012645Ac136ddd64DBA72", 3.14159e18 ]\n                      )\n\nOutput:\n  Description:        text/plain;Approve "ricmoose.eth" (0x8ba1f109551bD432803012645Ac136ddd64DBA72) to manage 3.14159 TOKN tokens?\n  Described Data:     0xa9059cbb0000000000000000000000000000000000000000000000002b992b75cbeb60000000000000000000000000008ba1f109551bd432803012645ac136ddd64dba72\n  i.e.                encodeWithSelector("approve(address,uint256)", "0x8ba1f109551bD432803012645Ac136ddd64DBA72", 3.14159e18)\n\nSigning:\n  Signed Transaction: 0xf8a280808094ab3045aa85cbcabb06ed3f3fe968fa545772727080b844a9059cbb0000000000000000000000000000000000000000000000002b992b75cbeb60000000000000000000000000008ba1f109551bd432803012645ac136ddd64dba7229a0f33ea492d326ac32d9b7ae203c61bf7cf0ac576fb0cf8be8e4c63dc89c90de12a06c8efb28aaf3b70c032b3bd1edfc664578c49f040cf749bb19b000da56507fb2\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br")])]),a("p",[a("strong",[e._v("Example: ENS commit")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Input:\n  Address:            0xab3045AA85cBCaBb06eD3F3FE968fA5457727270\n  Describer Input:    0x0f0e373f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000e31f43c1d823afaa67a8c5fbb8348176d225a79e65462b0520ef7d3df61b9992ed3bea0c56ead753be7c8b3614e0ce01e4cac41b00000000000000000000000000000000000000000000000000000000000000087269636d6f6f7365000000000000000000000000000000000000000000000000\n  i.e.                encode(\n                          [ "bytes4", "string", "address", "bytes32"],\n                          [ SEL("commit(string,address,bytes32)"), "ricmoose", "0xE31f43C1d823AfAA67A8C5fbB8348176d225A79e", "0x65462b0520ef7d3df61b9992ed3bea0c56ead753be7c8b3614e0ce01e4cac41b" ]\n                      )\n  \nOutput:\n  Description:        text/plain;Commit to the ENS name "ricmoose.eth" for 0xE31f43C1d823AfAA67A8C5fbB8348176d225A79e?\n  Described Data:     0xf14fcbc8e4a4f2bb818545497be34c7ab30e6e87e0001df4ba82e7c8b3f224fbaf255b91\n  i.e.                encodeWithSelector("commit(bytes32)", makeCommitment("ricmoose", "0xE31f43C1d823AfAA67A8C5fbB8348176d225A79e", "0x65462b0520ef7d3df61b9992ed3bea0c56ead753be7c8b3614e0ce01e4cac41b"))\n\nSigning:\n  Signed Transaction: 0xf88180808094ab3045aa85cbcabb06ed3f3fe968fa545772727080a4f14fcbc8e4a4f2bb818545497be34c7ab30e6e87e0001df4ba82e7c8b3f224fbaf255b912aa0a62b41d1ebda584fe84cf8a05f61b429fe4ec361e13c17f30a23281106b38a8da00bcdd896fe758d8f0cfac46445a48f76f5e9fe27790d67c51412cb98a12a0844\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br")])]),a("p",[a("strong",[e._v("Example: WETH mint()")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Input:\n  Address:            0xab3045AA85cBCaBb06eD3F3FE968fA5457727270\n  Describer Input:    0x1249c58b00000000000000000000000000000000000000000000000000000000\n  i.e.                encode(\n                          [ "bytes4" ],\n                          [ SEL("mint()") ]\n                      )\n  Value:              1.23 ether\n\nOutput:\n  Description:        text/plain;Mint 1.23 WETH (spending 1.23 ether)?\n  Described Data:     0x1249c58b\n  i.e.                encodeWithSelector("mint()")\n\nSigning:\n  Signed Transaction: 0xf86980808094ab3045aa85cbcabb06ed3f3fe968fa5457727270881111d67bb1bb0000841249c58b29a012df802e1394a97caab23c15c3a8c931668df4b2d6d604ca23f3f6b836d0aafca0071a2aebef6a9848616b4d618912f2003fb4babde3dba451b5246f866281a654\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br")])]),a("h2",{attrs:{id:"reference-implementation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reference-implementation"}},[e._v("#")]),e._v(" Reference Implementation")]),e._v(" "),a("p",[e._v("@TODO (consider adding it as one or more files in "),a("code",[e._v("../assets/eip-####/")]),e._v(")")]),e._v(" "),a("p",[e._v("I will add examples in Solidity and JavaScript.")]),e._v(" "),a("h2",{attrs:{id:"security-considerations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#security-considerations"}},[e._v("#")]),e._v(" Security Considerations")]),e._v(" "),a("h3",{attrs:{id:"escaping-text"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#escaping-text"}},[e._v("#")]),e._v(" Escaping Text")]),e._v(" "),a("p",[e._v("Wallets must be careful when displaying text provided by\ncontracts and proper efforts must be taken to sanitize\nit, for example, be sure to consider:")]),e._v(" "),a("ul",[a("li",[e._v("HTML could be enbedded to attempt to trick web-based wallets into "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Code_injection",target:"_blank",rel:"noopener noreferrer"}},[e._v("executing code"),a("OutboundLink")],1),e._v(" using the script tag (possibly uploading any private keys to a server)")]),e._v(" "),a("li",[e._v("In general, extreme care must be used when rendering HTML; consider the ENS names "),a("code",[e._v('<span style="display:none">not-</span>ricmoo.eth')]),e._v(" or "),a("code",[e._v("&thinsp;ricmoo.eth")]),e._v(", which if rendered without care would appear as "),a("code",[e._v("ricmoo.eth")]),e._v(", which it is not")]),e._v(" "),a("li",[e._v("Other marks which require escaping could be included, such as quotes ("),a("code",[e._v('"')]),e._v("), formatting ("),a("code",[e._v("\\n")]),e._v(" (new line), "),a("code",[e._v("\\f")]),e._v(" (form feed), "),a("code",[e._v("\\t")]),e._v(" (tab), any of many "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Whitespace_character#Spaces_in_Unicode",target:"_blank",rel:"noopener noreferrer"}},[e._v("non-standard whitespaces"),a("OutboundLink")],1),e._v("), back-slassh ("),a("code",[e._v("\\")]),e._v(")")]),e._v(" "),a("li",[e._v("UTF-8 has had bugs in the past which could allow arbitrary code execution and "),a("a",{attrs:{href:"https://osxdaily.com/2015/05/27/bug-crashes-messages-app-ios-workaround/",target:"_blank",rel:"noopener noreferrer"}},[e._v("crashing renderers"),a("OutboundLink")],1),e._v("; consider using the UTF-8 replacement character (or "),a("em",[e._v("something")]),e._v(") for code-points outside common planes or common sub-sets within planes")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://en.wikipedia.org/wiki/IDN_homograph_attack",target:"_blank",rel:"noopener noreferrer"}},[e._v("Homoglyphs attacks"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Right-to-left_mark",target:"_blank",rel:"noopener noreferrer"}},[e._v("Right-to-left"),a("OutboundLink")],1),e._v(" mark may affect rendering")]),e._v(" "),a("li",[e._v("Many other things, deplnding on your environment")])]),e._v(" "),a("h3",{attrs:{id:"distinguished-signed-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#distinguished-signed-data"}},[e._v("#")]),e._v(" Distinguished Signed Data")]),e._v(" "),a("p",[e._v("Applications implementing this EIP to sign message data should\nensure there are no collisions within the data which could\nresult in ambiguously signed data.")]),e._v(" "),a("p",[e._v("@TODO: Expand on this; compare packed data to ABI encoded data?")]),e._v(" "),a("h3",{attrs:{id:"enumeration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enumeration"}},[e._v("#")]),e._v(" Enumeration")]),e._v(" "),a("p",[e._v("If an abort occurs during signing, the response from this call\nshould match the response from a declined signing request;\notherwise this could be used for enumeration attacks, etc. A\nrandom interactive-scale delay should also be added, otherwise\na < 10ms response could be interpreted as an error.")]),e._v(" "),a("h3",{attrs:{id:"replayablility"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#replayablility"}},[e._v("#")]),e._v(" Replayablility")]),e._v(" "),a("p",[e._v("Transactions contain an explicit nonce, but signed messages do\nnot.")]),e._v(" "),a("p",[e._v("For many purposes, such as signing in, a nonce could be\ninjected (using block.timestamp) into the data. The log in\nservice can verify this is a recent timestamp. The timestamp\nmay or may not be omitted from the description string in this\ncase, as it it largely useful internally only.")]),e._v(" "),a("p",[e._v("In general, when signing messages a nonce often makes sense to\ninclude to prevent the same signed data from being used in the\nfuture.")]),e._v(" "),a("h2",{attrs:{id:"copyright"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[e._v("#")]),e._v(" Copyright")]),e._v(" "),a("p",[e._v("Copyright and related rights waived via "),a("a",{attrs:{href:"https://creativecommons.org/publicdomain/zero/1.0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CC0"),a("OutboundLink")],1),e._v(".")])])}),[],!1,null,null,null);t.default=n.exports}}]);