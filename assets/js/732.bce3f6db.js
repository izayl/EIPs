(window.webpackJsonp=window.webpackJsonp||[]).push([[732],{1157:function(t,e,a){"use strict";a.r(e);var i=a(46),n=Object(i.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"simple-summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simple-summary"}},[t._v("#")]),t._v(" Simple Summary")]),t._v(" "),a("p",[t._v("Provide access to the original recipient of a transaction.")]),t._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[t._v("#")]),t._v(" Abstract")]),t._v(" "),a("p",[t._v("This EIP introduces the following EVM instruction: "),a("code",[t._v("ENTRYPOINT")]),t._v(".")]),t._v(" "),a("p",[t._v("This instruction is meant to provide access to the original recipient of the transaction, the "),a("code",[t._v("to")]),t._v(" address, enabling new ways of introspection to be applied in conjunction with "),a("RouterLink",{attrs:{to:"/zh/eip-3508.html"}},[t._v("EIP-3508")]),t._v(".")],1),t._v(" "),a("h2",{attrs:{id:"motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[t._v("#")]),t._v(" Motivation")]),t._v(" "),a("p",[t._v("It is undeniable that smart contracts are becoming more interconnected than ever. Up until this point, smart contracts have entirely relied on compliant interfaces and introspection to introduce a new step in the call chain of a complex multi-contract interaction. However, this presents a forwards-only approach which limits the types of interactions that can manifest.")]),t._v(" "),a("p",[t._v("The purpose of this EIP is to provide a way via which a contract is able to identify the entry-point of a transaction on the blockchain and deduce what was the original intention of the transaction by applying introspection on the original transaction data itself.")]),t._v(" "),a("p",[t._v("This EIP enables the development of new types of smart contracts as it can open new pathways for "),a("a",{attrs:{href:"./eip-721"}},[t._v("EIP-721")]),t._v(" NFTs and "),a("a",{attrs:{href:"./eip-20"}},[t._v("EIP-20")]),t._v(" tokens to detect which action their transaction is part of, such as detecting a liquidity provision to a decentralized exchange or a loan within a collateralized lending protocol.")]),t._v(" "),a("h2",{attrs:{id:"specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[t._v("#")]),t._v(" Specification")]),t._v(" "),a("h3",{attrs:{id:"entrypoint-0x4a"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint-0x4a"}},[t._v("#")]),t._v(" ENTRYPOINT ("),a("code",[t._v("0x4a")]),t._v(")")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("ENTRYPOINT")]),t._v(" instruction uses 0 stack arguments and pushes the original "),a("code",[t._v("to")]),t._v(" member of the transaction onto the stack. The address yielded by the instruction is a 160-bit value padded to 256-bits. The operation costs "),a("code",[t._v("G_base")]),t._v(" to execute, similarly to "),a("code",[t._v("ORIGIN")]),t._v(" ("),a("code",[t._v("0x32")]),t._v(").")]),t._v(" "),a("p",[t._v("The address returned by the "),a("code",[t._v("ENTRYPOINT")]),t._v(" opcode will be equivalent to the "),a("code",[t._v("to")]),t._v(" address parameter specified in the nearest "),a("code",[t._v("AUTHCALL")]),t._v(" up the stack.  If there is no "),a("code",[t._v("AUTHCALL")]),t._v(" in the stack then "),a("code",[t._v("ENTRYPOINT")]),t._v(" will retrieve the original transaction's "),a("code",[t._v("to")]),t._v(" field.")]),t._v(" "),a("h2",{attrs:{id:"rationale"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rationale"}},[t._v("#")]),t._v(" Rationale")]),t._v(" "),a("h3",{attrs:{id:"authcall-0xf7-interaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authcall-0xf7-interaction"}},[t._v("#")]),t._v(" AUTHCALL ("),a("code",[t._v("0xf7")]),t._v(") Interaction")]),t._v(" "),a("p",[t._v("The "),a("RouterLink",{attrs:{to:"/zh/eip-3074.html"}},[t._v("EIP-3074")]),t._v(" introduced a new call instruction called "),a("code",[t._v("AUTHCALL")]),t._v(" ("),a("code",[t._v("0xf7")]),t._v(") that will replace a transaction's "),a("code",[t._v("ORIGIN")]),t._v(" ("),a("code",[t._v("0x32")]),t._v(") with the context variable "),a("code",[t._v("authorized")]),t._v(". The intention of "),a("code",[t._v("AUTHCALL")]),t._v(" is to prevent discrimination between smart contracts and EOAs which "),a("code",[t._v("ORIGIN")]),t._v(" initially facilitated. The "),a("code",[t._v("ENTRYPOINT")]),t._v(" opcode by itself re-introduces discrimination into the system as it indirectly allows one to evaluate whether the smart contract code being executed is done so by an EOA by validating that "),a("code",[t._v("ENTRYPOINT == ADDRESS")]),t._v(" where "),a("code",[t._v("ADDRESS")]),t._v(" ("),a("code",[t._v("0x30")]),t._v(") retrieves the currently executing account address. Therefore, it is sensible also replace the values retrieved by the "),a("code",[t._v("ENTRYPOINT")]),t._v(" opcode to the target of an "),a("code",[t._v("AUTHCALL")]),t._v(".")],1),t._v(" "),a("p",[t._v("This interaction ensures full compatibility with "),a("RouterLink",{attrs:{to:"/zh/eip-3074.html"}},[t._v("EIP-3074")]),t._v(" and ensures that no form of discrimination is introduced back into the system by this EIP.")],1),t._v(" "),a("h3",{attrs:{id:"naming-conventions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#naming-conventions"}},[t._v("#")]),t._v(" Naming Conventions")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("ENTRYPOINT")]),t._v(" instruction came to be by defining a sensible name that immediately and clearly depicts what it is meant to achieve by signaling the first interaction of a particular call, i.e. the entry-point.")]),t._v(" "),a("h3",{attrs:{id:"instruction-address-space"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#instruction-address-space"}},[t._v("#")]),t._v(" Instruction Address Space")]),t._v(" "),a("p",[t._v("Equivalent to "),a("a",{attrs:{href:"./eip-3508"}},[t._v("EIP-3508")]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"gas-cost"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gas-cost"}},[t._v("#")]),t._v(" Gas Cost")]),t._v(" "),a("p",[t._v("The opcode ENTRYPOINT ("),a("code",[t._v("0x4a")]),t._v(") essentially performs the same thing as the opcode ORIGIN ("),a("code",[t._v("0x32")]),t._v(") and thus shares the exact same gas cost.")]),t._v(" "),a("h3",{attrs:{id:"dependency-on-eip-3508"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dependency-on-eip-3508"}},[t._v("#")]),t._v(" Dependency on EIP-3508")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("ENTRYPOINT")]),t._v(" ("),a("code",[t._v("0x4a")]),t._v(") instruction alone has no perceivable benefit as it can be replaced by the "),a("code",[t._v("AUTHCALL")]),t._v(" ("),a("code",[t._v("0xf7")]),t._v(") instruction and as such should solely be introduced to the system in conjunction with the "),a("code",[t._v("ORIGINDATA*")]),t._v(" opcodes defined in "),a("RouterLink",{attrs:{to:"/zh/eip-3508.html"}},[t._v("EIP-3508")]),t._v(".")],1),t._v(" "),a("h2",{attrs:{id:"backwards-compatibility"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backwards-compatibility"}},[t._v("#")]),t._v(" Backwards Compatibility")]),t._v(" "),a("p",[t._v("The EIP does not alter or adjust existing functionality provided by the EVM and as such, no known issues exist.")]),t._v(" "),a("h2",{attrs:{id:"test-cases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-cases"}},[t._v("#")]),t._v(" Test Cases")]),t._v(" "),a("p",[t._v("TODO.")]),t._v(" "),a("h2",{attrs:{id:"security-considerations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#security-considerations"}},[t._v("#")]),t._v(" Security Considerations")]),t._v(" "),a("h3",{attrs:{id:"introspective-contracts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introspective-contracts"}},[t._v("#")]),t._v(" Introspective Contracts")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("ENTRYPOINT")]),t._v(" instruction allows the association of the "),a("code",[t._v("ORIGINDATALOAD")]),t._v(" and "),a("code",[t._v("ORIGINDATACOPY")]),t._v(" values with a particular smart contract address and interface, enabling introspection to be applied based on the function signature invoked and the arguments provided to reliably deduce the call-path via which a particular smart contract was invoked and allowing a more granular level of interaction to be defined in such special cases.")]),t._v(" "),a("p",[t._v("However, this type of introspection should solely be applied on pre-approved contracts rather than user-defined ones as the value stemming from this type of introspection entirely relies on a contract's code immutability and proper function, both of which a user supplied contract can easily bypass.")]),t._v(" "),a("h3",{attrs:{id:"caller-discrimination"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#caller-discrimination"}},[t._v("#")]),t._v(" Caller Discrimination")]),t._v(" "),a("p",[t._v("The instructions of this EIP should not be utilized as a way to discriminate between EOA callers and smart contracts, as this type of differentiation can be broken by an "),a("code",[t._v("AUTHCALL")]),t._v(" as defined in the specification chapter.")]),t._v(" "),a("h3",{attrs:{id:"contract-creation-behaviour"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contract-creation-behaviour"}},[t._v("#")]),t._v(" Contract Creation Behaviour")]),t._v(" "),a("p",[t._v("The behaviour of the "),a("code",[t._v("ENTRYPOINT")]),t._v(" opcode during a contract creation will result in the opcode yielding the zero-address as the first address interacted with in the transaction. This should be taken into account by contract implementations in a similar fashion to how "),a("code",[t._v("ecrecover")]),t._v(" invalid signatures are handled to prevent software misbehaviours from arising.")]),t._v(" "),a("h2",{attrs:{id:"copyright"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[t._v("#")]),t._v(" Copyright")]),t._v(" "),a("p",[t._v("Copyright and related rights waived via "),a("a",{attrs:{href:"https://creativecommons.org/publicdomain/zero/1.0/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CC0"),a("OutboundLink")],1),t._v(".")])])}),[],!1,null,null,null);e.default=n.exports}}]);