(window.webpackJsonp=window.webpackJsonp||[]).push([[798],{1227:function(e,t,a){"use strict";a.r(t);var s=a(46),i=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"simple-summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simple-summary"}},[e._v("#")]),e._v(" Simple Summary")]),e._v(" "),a("p",[e._v("Provide a standardized format for Ethereum Recovery Proposals (ERPs), which relate to recovery of certain classes of lost funds.  Individual ERPs will follow the same process as any EIP, but will be formatted and evaluated in a standard way to ensure consistency and transparency.")]),e._v(" "),a("p",[a("strong",[e._v("This EIP does not advocate for or against the acceptance of any particular recovery proposals, nor would its acceptance alone result in any state changes to the blockchain.")])]),e._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),a("p",[e._v("This proposal identifies a common solution method that can be used to address certain classes of lost funds on the Ethereum blockchain.  In particular, it is intended to address cases where there is no disagreement about the right outcome between directly affected parties, enabling timely and low-risk solutions to many issues that have already occurred or are likely to occur again as Ethereum grows.")]),e._v(" "),a("p",[e._v("The solution method is divided into three parts:")]),e._v(" "),a("ol",[a("li",[e._v("Standards that will need to be met by any follow-on ERP in order to be considered for approval.")]),e._v(" "),a("li",[e._v("Recommendations for a common format for ERPs to use to specify a set of corrective actions that can be interpreted by clients.")]),e._v(" "),a("li",[e._v("Guidelines for client teams to implement code that can read, interpret, and apply the corrective actions at a specific block.  The set of possible corrective actions is intentionally limited to minimize risk associated with any ERP.")])]),e._v(" "),a("h2",{attrs:{id:"motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[e._v("#")]),e._v(" Motivation")]),e._v(" "),a("p",[e._v("The issue of fund recovery on the Ethereum blockchain is often controversial. Frozen fund recovery proposals are almost never successful due to the relatively ad-hoc nature of such requests and the subjectivity that is often required to evaluate the merits. This EIP attempts to remove these barriers by providing both a standardized format for fund recovery EIPs and an objective standard by which to measure future proposals.")]),e._v(" "),a("h2",{attrs:{id:"specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[e._v("#")]),e._v(" Specification")]),e._v(" "),a("p",[e._v("This EIP describes a common format to be used for a subclass of EIPs, referred to as ethereum recovery proposals (ERPs), that propose an irregular state change required to address a fund recovery scenario that cannot be addressed using the standard protocol.  Each ERP will reference this EIP will follow the guidelines set out here.")]),e._v(" "),a("p",[e._v("The purpose of each ERP is (a) to clearly describe the issue to be corrected, (b) to describe why an irregular state change is both necessary and justified, and (c) to demonstrate that the proposed actions will achieve the ERP's objectives.")]),e._v(" "),a("p",[e._v("Each ERP will be required to use a standard format to represent the set of proposed state changes and must include a verification script that can reliably generate those changes.  ERPs that do not meet (at least) these requirements will not be considered for approval.")]),e._v(" "),a("p",[e._v("Each ERP should contain the following items:")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("Preamble")]),e._v(": EIP (RFC 822) header containing metadata about the ERP, including the EIP number, a short title (44 character maximum), and the real names (and optional contact information) for each author.")]),e._v(" "),a("li",[a("strong",[e._v("Simple Summary")]),e._v(": A simplified and layman-accessible explanation of the ERP.")]),e._v(" "),a("li",[a("strong",[e._v("Detailed description")]),e._v(": A human-readable description of the proposed corrective actions and the criteria used to determine the proposed actions.")]),e._v(" "),a("li",[a("strong",[e._v("Justification")]),e._v(": A concise description of why the corrective actions are both reasonable and unlikely to be challenged by any directly affected party.")]),e._v(" "),a("li",[a("strong",[e._v("Verification script")]),e._v(": A machine-readable script that outputs one State Change Object. The script should clearly implement the selection and action generating logic outlined in the description such that reviewers can independently re-generate an identical State Change Object.")]),e._v(" "),a("li",[a("strong",[e._v("State Change Object")]),e._v(": The output of the verification script and the input to the ethereum clients.  Primarily, it specifies the complete set of proposed state change actions.")]),e._v(" "),a("li",[a("strong",[e._v("Appendix (optional)")]),e._v(": with supporting evidence. Attachments in the appendix may include documents verifying details specified as part of the recovery proposal description.")])]),e._v(" "),a("p",[e._v("The following sections give more detailed descriptions of the expectations for the Justification, Verification Script, and the format of the State Change Object.")]),e._v(" "),a("h3",{attrs:{id:"justification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#justification"}},[e._v("#")]),e._v(" Justification")]),e._v(" "),a("p",[e._v("A concise description of why this action is both reasonable (cannot be accomplished without an irregular state change) and unlikely to be challenged by a "),a("em",[e._v("directly")]),e._v(" affected party.")]),e._v(" "),a("p",[a("strong",[e._v("Considerable example")]),e._v(" (concise, includes supporting evidence, no negative impact): "),a("em",[e._v("A crowdsale run by XYZ incorrectly published the testnet address of their crowdsale contract to their public website at the start of their crowdsale on Jan 19, 2018.  501 ETH was sent by 328 users on the mainnet to the incorrect address between block 4,235,987 and 4,236,050.  See here for the testnet contract, and see here for the transactions to the same address on the mainnet.  See here for a statement made by XYZ on their website.  Because there is a contract at this address on the testnet and the corresponding nonce for the creator address has already been used on the mainnet, it is considered effectively impossible that anyone coincidentally holds the private key. We have verified that all transactions came from addresses with no associated code, so there should be no issue returning eth to the senders.")])]),e._v(" "),a("p",[a("strong",[e._v("Insufficient example")]),e._v(" (not enough detail, no supporting evidence): "),a("em",[e._v("We accidentally put the wrong contract address up on our website.  Can you please refund any eth sent to 0x1234 back to the senders.  Thanks.")])]),e._v(" "),a("p",[a("strong",[e._v("Unacceptable example")]),e._v(" (not objective, one person’s word against another): "),a("em",[e._v("I sent tokens to X for services and he did a lousy job.  I want my money back, but he won’t refund me.  Please help!!")])]),e._v(" "),a("h3",{attrs:{id:"verification-script"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#verification-script"}},[e._v("#")]),e._v(" Verification Script")]),e._v(" "),a("p",[e._v("A machine-readable script that outputs a single State Change Object. This script should be implemented so that it is easily audited by a reviewer. Verification scripts should be javascript files that may use the "),a("a",{attrs:{href:"https://github.com/ethereum/web3.js/",target:"_blank",rel:"noopener noreferrer"}},[e._v("web3.js"),a("OutboundLink")],1),e._v(" library.")]),e._v(" "),a("p",[e._v("There are a few guidelines for verification scripts:")]),e._v(" "),a("ul",[a("li",[e._v("Scripts should always be written to be as concise as reasonably possible, and anyone executing the verification script should review it first to verify that it does not contain any unsafe operations.")]),e._v(" "),a("li",[e._v("No verification script should ever require an unlocked ethereum wallet")]),e._v(" "),a("li",[e._v("The script should hardcode the highest block included during execution (otherwise the results may differ between runs).")])]),e._v(" "),a("p",[e._v("The purpose of the ERP Verification script is to unambiguously specify (through code) the criteria used to compute the set of State Change Actions.  The script’s output, as described above, will be the input used by all Ethereum clients.  Client teams should avoid manually pre-processing the artifact or using the artifact to simply guide changes in the code.  Instead, the artifact should be bundled with the client and processed directly by the client at the specified block. This will minimize the amount of client effort required for each ERP and help to ensure compatibility between clients. We anticipate that some ERP Verification scripts may be trivial, but we recommend their inclusion for consistency.")]),e._v(" "),a("h3",{attrs:{id:"state-change-object"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state-change-object"}},[e._v("#")]),e._v(" State Change Object")]),e._v(" "),a("p",[e._v("The State Change Object is a standard format that will be interpretable by all Ethereum clients.")]),e._v(" "),a("p",[e._v("It is a single JSON object containing the following fields:")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("erpId")]),e._v(": A string identifier for this ERP (likely the associated EIP number, e.g. “EIP-1234”).  This will be converted from ascii to a hex string, then added as extra data on the target block.")]),e._v(" "),a("li",[a("strong",[e._v("targetBlock")]),e._v(": The block at which the stateChange should be applied.  Clients would use this to determine when a set of state changes should occur")]),e._v(" "),a("li",[a("strong",[e._v("actions")]),e._v(": An array of State Change Actions.")]),e._v(" "),a("li",[a("strong",[e._v("metadata")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("sourceBlock")]),e._v(": The highest block considered by the script when it was run.")]),e._v(" "),a("li",[a("strong",[e._v("version")]),e._v(": The version of the verification script when it was run.")])])])]),e._v(" "),a("h3",{attrs:{id:"state-change-actions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state-change-actions"}},[e._v("#")]),e._v(" State Change Actions")]),e._v(" "),a("p",[e._v("A State Change action is a JSON object that includes a “type” field and a set of “data” fields, where the contents of the data fields are dependent on the type and must follow the schema defined for that type.  This allows clients to support a limited set of operations initially and add more based on a subsequent EIP if needed.  Support for the following action types should be implemented by clients upon adoption of this EIP:")]),e._v(" "),a("h4",{attrs:{id:"weitransfer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#weitransfer"}},[e._v("#")]),e._v(" weiTransfer")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("weiTransfer")]),e._v(" action transfers ETH from one address to another.")]),e._v(" "),a("p",[a("em",[e._v("Data fields")])]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("type")]),e._v(" ("),a("em",[e._v("string")]),e._v("): "),a("code",[e._v("weiTransfer")])]),e._v(" "),a("li",[a("strong",[e._v("fromAddress")]),e._v(" ("),a("em",[e._v("hex string")]),e._v("): The address from which ETH should be transferred")]),e._v(" "),a("li",[a("strong",[e._v("toAddress")]),e._v(" ("),a("em",[e._v("hex string")]),e._v("): The address to which ETH should be sent")]),e._v(" "),a("li",[a("strong",[e._v("value")]),e._v(" ("),a("em",[e._v("decimal string")]),e._v("): The amount of ETH to be transferred, in units of wei. The value must be a whole number greater than zero.")])]),e._v(" "),a("h4",{attrs:{id:"storecode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#storecode"}},[e._v("#")]),e._v(" storeCode")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("storeCode")]),e._v(" action stores the given code at the given address.")]),e._v(" "),a("p",[a("em",[e._v("Data fields")])]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("type")]),e._v(" ("),a("em",[e._v("string")]),e._v("): "),a("code",[e._v("storeCode")])]),e._v(" "),a("li",[a("strong",[e._v("toAddress")]),e._v(" ("),a("em",[e._v("hex string")]),e._v("): The address to which the contract should be restored.")]),e._v(" "),a("li",[a("strong",[e._v("expectedCodeHash")]),e._v(" ("),a("em",[e._v("hex string")]),e._v("): the expected hash of the code already at the toAddress.The empty string should be used if no code is expected at the toAddress.  In all other cases, the “0x” prefix is optional.")]),e._v(" "),a("li",[a("strong",[e._v("code")]),e._v(" ("),a("em",[e._v("hex string")]),e._v("): the new bytecode associated with the contract")])]),e._v(" "),a("h3",{attrs:{id:"appendix-optional"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#appendix-optional"}},[e._v("#")]),e._v(" Appendix (Optional)")]),e._v(" "),a("p",[e._v("The appendix can include additional supporting evidence or attachments that will help reviewers understand or verify the claims made in the ERP.")]),e._v(" "),a("p",[e._v("For the storeCode operation, it should include the proposed contract source (e.g. Solidity) as well as the other details required such that a reviewer can compile the source and generate the same bytecode.  It should also include the source that was originally stored at that address, if possible/applicable.  If the two contracts are not identical, changes should be noted. If they are identical, the author should indicate why no changes are necessary (this is unlikely). Additionally, any relevant reviews, audits, and test cases should be included to the extent that they address the issues encountered with the original contract.")]),e._v(" "),a("p",[e._v("If accepted, an ERP could easily compile the block at while the changes are to take place, and the source of the actions (which would be the output of the script, in a standardized object output). These can be bundled with the client for seamless execution.")]),e._v(" "),a("h2",{attrs:{id:"erp-approval-process"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#erp-approval-process"}},[e._v("#")]),e._v(" ERP Approval Process")]),e._v(" "),a("p",[e._v("ERPs are a subclass of EIPs and will, therefore, follow the same approval process.")]),e._v(" "),a("h3",{attrs:{id:"testing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#testing"}},[e._v("#")]),e._v(" Testing")]),e._v(" "),a("p",[a("em",[e._v("The ERP authors are currently seeking feedback from client teams about the proper testing procedures")])]),e._v(" "),a("h2",{attrs:{id:"ethereum-client-implementation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ethereum-client-implementation"}},[e._v("#")]),e._v(" Ethereum Client Implementation")]),e._v(" "),a("p",[e._v("Clients that choose to adopt the proposal outlined in this EIP will implement a module that scans a designated directory for SCO files (each time the client process launches) to construct a mapping between target blocks and SCO file names.  When starting work on a new block, clients should first consult the set of SCO target blocks discovered and determine if there are any recovery actions required for the current block.")]),e._v(" "),a("p",[e._v("E.g. in this example, "),a("code",[e._v("erpsByTargetBlock")]),e._v(" is the mapping between the target block number associated with each ERP's State Change Object and a reference (i.e. file name) to the resource with the actual data.")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("if (erpsByTargetBlock.get(currentBlock) != null) {\n    try {\n        applyRecoveryActions(erpsByTargetBlock.get(currentBlock));\n     }\n     catch (e) {\n        // recovery actions should be treated as a batch.  \n        // If one fails, they all fail.\n     }\n}\n\n\n// continue with normal block processing...\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br")])]),a("p",[e._v("The "),a("code",[e._v("applyRecoveryActions")]),e._v(" method must apply the recovery actions in the same order as they are stored in the SCO file.  Clients are responsible for ensuring that no State Change Action will result in an account transferring an amount that is greater than its current balance.  The "),a("code",[e._v("toAddress")]),e._v(" for both "),a("code",[e._v("weiTransfer")]),e._v(" and "),a("code",[e._v("storeCode")]),e._v(" should always be a valid address (i.e. never "),a("code",[e._v("0x0")]),e._v(").")]),e._v(" "),a("p",[e._v("Additionally, each block affected by an ERP should include extra data to indicate that the state change occurred.  The extra data included in the block should be the erpId found in the SCO file, converted to hex (i.e. "),a("code",[e._v("hexStringToBytes(asciiToHex(erpId))")]),e._v(").  Clients should also validate that the expected header appears in the target block if the block is received from a peer.")]),e._v(" "),a("p",[e._v("The ERP should link to pull requests for each client repository, and these pull requests should link back to the ERP and also contain its EIP preamble and summary.")]),e._v(" "),a("p",[e._v("Each PR associated with an ERP should consist of a single file (the SCO file) added to the client’s designated SCO directory.  No additional client code should be required.")]),e._v(" "),a("h3",{attrs:{id:"limitations-of-this-eip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#limitations-of-this-eip"}},[e._v("#")]),e._v(" Limitations of this EIP")]),e._v(" "),a("p",[e._v("This EIP is focused on standardizing how recovery proposals can be formatted, to optimize readability and eliminate or minimize as much as possible the potential for mistakes or intentional abuses.")]),e._v(" "),a("p",[e._v("The following are considered out of scope from this EIP:")]),e._v(" "),a("ul",[a("li",[e._v("Which fund recovery proposals, if any, should be accepted for implementation.")]),e._v(" "),a("li",[e._v("How common classes of recovery proposal plaintiff may organize ERPs representing a collective group of individual parties")])]),e._v(" "),a("h2",{attrs:{id:"rationale"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rationale"}},[e._v("#")]),e._v(" Rationale")]),e._v(" "),a("p",[e._v("The primary consideration for the approach described above was to minimize the amount of risk associated with recovery actions that would otherwise not have a viable solution.  A secondary consideration was to standardize the format used in the proposals for recovery actions.")]),e._v(" "),a("p",[e._v("First, including a verification script guarantees that the way in which the recovery actions were determined is unambiguous.  This does not mean that the recovery actions are necessarily correct, only that the logic used to determine them is fully specified and auditable.")]),e._v(" "),a("p",[e._v("Second, requiring that the output of the verification script is directly interpretable by client programs minimizes the work necessary for each client to adopt a particular ERP.  It also reduces the risk that two clients will make different decisions about the implementation of a particular ERP.")]),e._v(" "),a("p",[e._v("Third, action types are intentionally limited and inflexible, which reduces the likelihood of unintended consequences or maliciously constructed files affecting the blockchain state.  The format is easily extensible with new actions types if needed but that would require a separate EIP.")]),e._v(" "),a("h2",{attrs:{id:"implementation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#implementation"}},[e._v("#")]),e._v(" Implementation")]),e._v(" "),a("p",[e._v("A reference implementation has been written for the EthereumJ platform. See the pull request "),a("a",{attrs:{href:"https://github.com/ethereum/ethereumj/pull/1004#commits-pushed-1105610",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"erp-examples"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#erp-examples"}},[e._v("#")]),e._v(" ERP Examples")]),e._v(" "),a("p",[e._v("This section will include examples and SCO resource files, as well as a brief tutorial on how to test using a private testnet.")]),e._v(" "),a("h2",{attrs:{id:"copyright"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[e._v("#")]),e._v(" Copyright")]),e._v(" "),a("p",[e._v("Copyright and related rights waived via "),a("a",{attrs:{href:"https://creativecommons.org/publicdomain/zero/1.0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CC0"),a("OutboundLink")],1),e._v(".")])])}),[],!1,null,null,null);t.default=i.exports}}]);